\documentclass[11pt]{article}
\usepackage{sectsty}
\usepackage{enumerate}
\usepackage{bm}
\usepackage{amsmath, amsthm, amssymb}
\usepackage[usenames,dvipsnames]{color}
\usepackage{float, graphicx}
\usepackage{environ}
\usepackage{xeCJK}

\providecommand{\abs}[1]{\lvert#1\rvert}
\providecommand{\norm}[1]{\lVert#1\rVert}

\usepackage[sc]{mathpazo} % math & rm
\linespread{1.05}        % Palatino needs more leading (space between lines)
\usepackage[scaled=0.90]{helvet} % ss
% \usepackage[scaled=0.85]{sourcecodepro} % tt
\usepackage[T1]{fontenc}
\usepackage{textcomp}


\newtheorem{thm}{Theorem}
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{fact}[thm]{Fact}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{eg}{Example}
\newtheorem{ex}{Exercise}
\newtheorem{defi}{Definition}
\newtheorem{hw}{Problem}
\newenvironment{sol}
{\par\vspace{3mm}\noindent{\it Solution}.}
{\qed}

\newcommand{\ov}{\overline}
\newcommand{\cb}{{\cal B}}
\newcommand{\cc}{{\cal C}}
\newcommand{\cd}{{\cal D}}
\newcommand{\ce}{{\cal E}}
\newcommand{\cf}{{\cal F}}
\newcommand{\ch}{{\cal H}}
\newcommand{\cl}{{\cal L}}
\newcommand{\cm}{{\cal M}}
\newcommand{\cp}{{\cal P}}
\newcommand{\cz}{{\cal Z}}
\newcommand{\eps}{\varepsilon}
\newcommand{\ra}{\rightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\Ra}{\Rightarrow}
\newcommand{\dist}{\mbox{\rm dist}}
\newcommand{\bn}{{\mathbf N}}

\newcommand{\bA}{ \bm{A} }
\newcommand{\bI}{ \bm{I} }
\newcommand{\bM}{ \bm{M} }
\newcommand{\bx}{ \bm{x} }
\newcommand{\bV}{ \bm{V} }
\newcommand{\bC}{ \bm{C} }
\newcommand{\bc}{ \bm{c} }
\newcommand{\bU}{ \bm{U} }
\newcommand{\bR}{ \bm{R} }
\newcommand{\bW}{ \bm{W} }
\newcommand{\bX}{ \bm{X} }
\newcommand{\bY}{ \bm{Y} }
\newcommand{\bZ}{ \bm{Z} }
% \setlength{\parindent}{0pt}
% \setlength{\parskip}{2ex}
% \newenvironment{proofof}[1]{\bigskip\noindent{\itshape #1. }}{\hfill$\Box$\medskip}

\usepackage{enumerate,fullpage,proof,color,hyperref}


\newcommand{\todo}[1] { \color{red}[TODO: #1]\color{black} }


\newcommand{\alns}[1] {
	\begin{align*} #1 \end{align*}
}
\newcommand{\pd}[2] {
  \frac{\partial #1}{\partial #2}
}

\title{Big Data Processing: homework 6}
\author{凌康伟 \qquad 5140219295}

\begin{document}
\maketitle

\section*{Exercise 1}
\begin{table}[H]
  \centering
  \begin{tabular}{c|c|c|c|c|c|c|c|c|c|c} \hline
    & \multicolumn{6}{c|}{query} & \multicolumn{3}{c|}{document} & \\ \hline
    word & tf & wf & df & idf & wf-idf & $q_i$ & tf & wf & $d_i$ & $q_i\cdot d_i$  \\ \hline
    digital & 1 & 1&10,000 & 3 & 3 & 0.79 & 1 & 1  & 0.52 & 0.41\\ \hline
    video & 0& 0&100,000  & 2  & 0 & 0    & 1 & 1  & 0.52 & 0\\ \hline
    cameras & 1&1 &50,000 & 2.3&2.3&  0.61& 2 &1.3 & 0.68 & 0.41\\ \hline
  \end{tabular}
\end{table}
\[
  \mbox{final similarity} = 0.41 + 0.41 = 0.82
\]

\section*{Exercise 2}
\subsection*{nnn.atc}
\begin{figure}[H]
  \begin{minipage}{0.5\linewidth}
    \begin{table}[H]
      \centering
      \begin{tabular}{|c|c|c|c|c|} \hline
        & \multicolumn{4}{|c|}{Query(atc weight)}\\ \hline
        Term         & tf& idf  & tf-idf & atc weight \\ \hline
        Car          & 1 & 1.65 & 1.65& 0.599 \\ \hline
        Auto         & 0 & 2.08 & 0   & 0\\ \hline
        Insurance    & 1 & 1.62 & 1.62& 0.589\\ \hline
        Best         & 1 & 1.5  & 1.5 & 0.544\\ \hline
      \end{tabular}
    \end{table}
  \end{minipage}
  \begin{minipage}{0.5\linewidth}
    \begin{table}[H]
      \centering
      \begin{tabular}{|c|c|c|c|c|} \hline
        & \multicolumn{4}{|c|}{Doc 1(nnn weight)}\\ \hline
        Term     & tf & idf & tf-idf & nnn weight \\ \hline
        Car      & 27 &1& 27& 27 \\ \hline
        Auto     & 3  &1& 3& 3\\ \hline
        Insurance& 0  &1& 0& 0\\ \hline
        Best     & 14 &1& 14& 14\\ \hline
      \end{tabular}
    \end{table}
  \end{minipage}
  \begin{minipage}{0.5\linewidth}
    \begin{table}[H]
      \centering
      \begin{tabular}{|c|c|c|c|c|} \hline
        & \multicolumn{4}{|c|}{Doc 2(nnn weight)}\\ \hline
        Term     & tf & idf & tf-idf & nnn weight \\ \hline
        Car      & 4  &1    & 4 & 4 \\ \hline
        Auto     & 33 &1    & 33& 33\\ \hline
        Insurance& 33 &1    & 33& 33\\ \hline
        Best     & 0  &1    & 0 & 0\\ \hline
      \end{tabular}
    \end{table}
  \end{minipage}
  \begin{minipage}{0.5\linewidth}
    \begin{table}[H]
      \centering
      \begin{tabular}{|c|c|c|c|c|} \hline
        & \multicolumn{4}{|c|}{Doc 3(nnn weight)}\\ \hline
        Term     & tf & idf & tf-idf & nnn weight \\ \hline
        Car      & 24 &1 & 24& 24 \\ \hline
        Auto     & 0  &1 & 0& 0\\ \hline
        Insurance& 29 &1 & 29& 29\\ \hline
        Best     & 17 &1 & 17& 17\\ \hline
      \end{tabular}
    \end{table}
  \end{minipage}
\end{figure}
\begin{align*}
  Sim(Query, Doc 1) &= 23.789 \\
  Sim(Query, Doc 2) &= 21.833 \\
  Sim(Query, Doc 3) &= 40.705 \\
\end{align*}
Ranking (from high to low): Doc 3, Doc 1, Doc 2

\subsection*{ntc.atc}
\begin{figure}[H]
  \begin{minipage}{0.5\linewidth}
    \begin{table}[H]
      \centering
      \begin{tabular}{|c|c|c|c|c|} \hline
        & \multicolumn{4}{|c|}{Query(atc weight)}\\ \hline
        Term         & tf& idf  & tf-idf & atc weight \\ \hline
        Car          & 1 & 1.65 & 1.65& 0.599 \\ \hline
        Auto         & 0 & 2.08 & 0   & 0\\ \hline
        Insurance    & 1 & 1.62 & 1.62& 0.589\\ \hline
        Best         & 1 & 1.5  & 1.5 & 0.544\\ \hline
      \end{tabular}
    \end{table}
  \end{minipage}
  \begin{minipage}{0.5\linewidth}
    \begin{table}[H]
      \centering
      \begin{tabular}{|c|c|c|c|c|} \hline
        & \multicolumn{4}{|c|}{Doc 1(ntc weight)}\\ \hline
        Term     & tf & idf & tf-idf & ntc weight \\ \hline
        Car      & 27 &1.65& 44.55& 0.897 \\ \hline
        Auto     & 3  &2.08& 6.24 & 0.126\\ \hline
        Insurance& 0  &1.62& 0    & 0\\ \hline
        Best     & 14 &1.5 & 21   & 0.423\\ \hline
      \end{tabular}
    \end{table}
  \end{minipage}
  \begin{minipage}{0.5\linewidth}
    \begin{table}[H]
      \centering
      \begin{tabular}{|c|c|c|c|c|} \hline
        & \multicolumn{4}{|c|}{Doc 2(ntc weight)}\\ \hline
        Term     & tf & idf & tf-idf & ntc weight \\ \hline
        Car      & 4  &1.65 & 6.6  & 0.076 \\ \hline
        Auto     & 33 &2.08 & 68.64& 0.787\\ \hline
        Insurance& 33 &1.62 & 53.46& 0.613\\ \hline
        Best     & 0  &1.5  & 0    & 0\\ \hline
      \end{tabular}
    \end{table}
  \end{minipage}
  \begin{minipage}{0.5\linewidth}
    \begin{table}[H]
      \centering
      \begin{tabular}{|c|c|c|c|c|} \hline
        & \multicolumn{4}{|c|}{Doc 3(ntc weight)}\\ \hline
        Term     & tf & idf & tf-idf & ntc weight \\ \hline
        Car      & 24 &1.65 & 39.6 & 0.595 \\ \hline
        Auto     & 0  &2.08 & 0    & 0\\ \hline
        Insurance& 29 &1.62 & 46.98& 0.706\\ \hline
        Best     & 17 &1.5  & 25.5 & 0.383\\ \hline
      \end{tabular}
    \end{table}
  \end{minipage}
\end{figure}
\begin{align*}
  Sim(Query, Doc 1) &= 0.767 \\
  Sim(Query, Doc 2) &= 0.407 \\
  Sim(Query, Doc 3) &= 0.981 \\
\end{align*}
Ranking (from high to low): Doc 3, Doc 1, Doc 2
\end{document}